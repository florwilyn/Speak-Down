{% extends 'base.html' %}

{% block content %}
	<h3 style="text-align: center;"><b>Hello, {{request.user.username}}</b></h3>
	<h4 style="text-align: center; margin-top: 0px">You have {{ forum|length }} submissions to be reviewed.</h4>
	<ul>
		{% for forum in forum %}
		<li style="list-style-type:none;" style="text-align: center;">
			<form method="POST" action="{% url 'approve' %}" name ="post_form" id ="post_form">
			{% csrf_token %}
			<div class="panel panel-default" style="margin: 0 auto; display: block; width: 50%; margin-bottom: 10px">
			<div class="title" style="margin-top: 10px">
				<span style="margin: 10px"><b>#{{forum.title}}</b></span>
			</div>
			  <div class="panel-body">
			  {% if forum.image %}
				  		<img src="{{forum.image.url}}" alt="" class="img-responsive center-block" />
				  	{% endif %}
			    {{forum.content}}
			    <br><br>
			    <small style="vertical-align: bottom;">
			    by {{forum.user}} - {{forum.date}}
			    </small>
			  </div>
			  <div class="panel-footer">
				    <input type="hidden" name="requests_id" value="{{forum.id}}">
					<button type="button" class="post btn btn-primary">Post to Forum</button>
					<button type="button" class="delete btn btn-danger">Delete</button>
				</div>
			</div>
			</form>
		</li>
		{% endfor %}
	</ul>
{% endblock %}
{% block script %}
<script type="text/javascript">
    $('.post').on('click', function () {
    $.confirm({
        title: 'Confirm Submission',
        content: 'You are about to submit a form.',
        buttons: {
            submit: {
                text: 'Submit',
                btnClass: 'btn-blue',
                keys: [
                    'enter',
                    'shift'
                ],
                action: function () {
                    this.$content // reference to the content
                    document.post_form.submit()
                    // $.alert('Submitting...');
                }
            },
            cancel: function () {
                // $.alert('Canceled!');
            },
        }
    });
                
    $('.delete').on('click', function () {
        $.confirm({
            title: 'Confirm Submission',
            content: 'You are about to submit a form.',
            buttons: {
                submit: {
                    text: 'Submit',
                    btnClass: 'btn-blue',
                    keys: [
                        'enter',
                        'shift'
                    ],
                    action: function () {
                        this.$content // reference to the content
                        $("#post_form").attr("action", "{%  url 'delete' %}");
                        document.post_form.submit()
                        // $.alert('Submitting...');
                    }
                },
                cancel: function () {
                    // $.alert('Canceled!');
                },
            }
        });
    });
</script>
{% endblock %}